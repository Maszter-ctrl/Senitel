<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sentinel â€” Linux Process Blocker</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
  <style>
    body { margin:0; padding:40px; background:#f0f0f0; color:#222; font-family:"Cantarell","Ubuntu","DejaVu Sans",system-ui,sans-serif; }
    .container { max-width:700px; margin:0 auto; background:#fff; padding:25px; border:1px solid #ccc; position:relative; }
    h1 { display:flex; align-items:center; margin-top:0; }
    .logo { height:50px; width:auto; margin-right:15px; }
    .version { font-size:36px; font-weight:bold; color:#19F; margin-bottom:20px; text-align:center; opacity:0; transform:translateY(-20px); transition: all 1s ease; }
    .linux-button { display:inline-flex; align-items:center; justify-content:center; padding:8px 20px; font-size:14px; font-family:"Cantarell","Ubuntu","DejaVu Sans",system-ui,sans-serif; font-weight:500; color:white; background-color:#2e7d32; border:1px solid #1b5e20; border-radius:4px; cursor:pointer; transition: background-color 0.15s, box-shadow 0.15s, transform 0.15s; text-decoration:none; margin:6px 0; }
    .linux-button--gray { background-color:#555; border-color:#333; }
    .linux-button:hover { background-color:#388e3c; box-shadow:0 4px 8px rgba(0,0,0,0.2); transform:translateY(-2px); }
    .icon { margin-right:6px; }
    section { margin-top:25px; }
    ol, ul { padding-left:20px; }
    li { margin-bottom:6px; }
    hr { border:none; border-top:1px solid #ddd; margin:25px 0; }
    .note { font-style:italic; color:#555; margin-top:10px; }
    textarea { width:100%; height:80px; margin-top:10px; padding:8px; font-family:"Cantarell","Ubuntu","DejaVu Sans",system-ui,sans-serif; font-size:14px; border:1px solid #aaa; border-radius:4px; }
    .feedback-message { color:green; font-weight:bold; margin-top:10px; }

    /* Download Modal */
    .download-modal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); display:none; justify-content:center; align-items:center; z-index:1000; }
    .download-dialog { background:#fff; padding:25px 30px; width:400px; border-radius:6px; box-shadow:0 4px 20px rgba(0,0,0,0.25); font-family:"Cantarell","Ubuntu","DejaVu Sans",system-ui,sans-serif; }
    .download-title { font-size:18px; margin-bottom:20px; }
    .progress-container { width:100%; background:#ddd; border-radius:4px; overflow:hidden; height:18px; margin-bottom:10px; }
    .progress-bar { width:0%; height:100%; background-color:#2e7d32; text-align:center; color:white; line-height:18px; font-size:12px; transition: width 0.2s ease; }
    .cancel-btn { display:inline-block; padding:5px 15px; border-radius:4px; border:1px solid #999; background:#eee; cursor:pointer; font-size:13px; }
    .cancel-btn:hover { background:#ddd; }
  </style>
</head>
<body>
<div class="container">
  <h1>
    <img src="/static/logo.jpg" alt="Sentinel Logo" class="logo">
    Sentinel
  </h1>

  <div class="version" id="version">Version {{ version }}</div>

  <p>Download Sentinel to monitor and block unwanted processes on Linux. Inspect the source if you prefer to build it yourself.</p>

  <!-- Linux download -->
  <button class="linux-button" data-url="/downloads/blocker_linux" id="download-linux">
    <i class="fa-brands fa-linux icon"></i>Download for Linux
  </button>

  <!-- Source download -->
  <button class="linux-button linux-button--gray" data-url="/downloads/blocker_source.zip" id="download-source">
    <i class="fa-solid fa-code icon"></i>Download Source (zip)
  </button>

  <!-- Feedback -->
  <section>
    <h2>Feedback</h2>
    {% if message %}
      <div class="feedback-message">{{ message }}</div>
    {% endif %}
    <form method="post" style="max-width:500px;">
      <textarea name="feedback" placeholder="Leave your feedback here..."></textarea>
      <br>
      <button type="submit" class="linux-button linux-button--gray">Submit Feedback</button>
    </form>
  </section>

  <section>
    <h2>Getting Started</h2>
    <ol>
      <li>Download the Linux binary or source code.</li>
      <li>Run the agent: <code>./blocker_linux</code></li>
      <li>Add process names to <code>blocklist.json</code> or via CLI.</li>
      <li>The agent continuously monitors running processes and terminates matches automatically.</li>
    </ol>
    <p><a href="/build-guide">Read the full detailed build guide (source ZIP required)</a></p>
  </section>


  <section>
    <h2>Features</h2>
    <ul>
      <li>Real-time process monitoring.</li>
      <li>Customizable blocklist.</li>
      <li>Lightweight Python core with Linux binary.</li>
      <li>Logging of blocked processes.</li>
    </ul>
  </section>

  <hr>

  <section>
    <h2>Safety Notes</h2>
    <ul>
      <li>Requires sufficient permissions to terminate processes.</li>
      <li>Terminating critical processes may destabilize your system.</li>
      <li>Inspect source code before running on untrusted machines.</li>
    </ul>
    <p class="note">Defaults prevent blocking system-critical processes, but caution is advised.</p>
  </section>
</div>

<!-- Download Modal -->
<div class="download-modal" id="download-modal">
  <div class="download-dialog">
    <div class="download-title">Downloading...</div>
    <div class="progress-container">
      <div class="progress-bar" id="modal-progress">0%</div>
    </div>
    <div style="text-align:right;">
      <span class="cancel-btn" id="cancel-download">Cancel</span>
    </div>
  </div>
</div>

<script>
  // Animate version
  window.addEventListener("DOMContentLoaded", () => {
    const version = document.getElementById("version");
    setTimeout(() => {
      version.style.opacity = 1;
      version.style.transform = "translateY(0)";
    }, 300);
  });

  const downloadButtons = document.querySelectorAll("button[data-url]");
  const modal = document.getElementById("download-modal");
  const progressBar = document.getElementById("modal-progress");
  const cancelBtn = document.getElementById("cancel-download");
  let downloadInterval;

  downloadButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      const url = btn.getAttribute("data-url");
      modal.style.display = "flex";
      progressBar.style.width = "0%";
      progressBar.textContent = "0%";
      let progress = 0;

      // Simulate progress
      downloadInterval = setInterval(() => {
        progress += Math.random()*8 + 2; // random step
        if(progress >= 100) progress = 100;
        progressBar.style.width = progress+"%";
        progressBar.textContent = Math.floor(progress)+"%";

        if(progress >= 100){
          clearInterval(downloadInterval);
          modal.style.display = "none";
          const a = document.createElement("a");
          a.href = url;
          const parts = url.split('/');
          a.download = parts[parts.length - 1]; // ensures correct filename
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
        }
      }, 100);
    });
  });

  cancelBtn.addEventListener("click", () => {
    clearInterval(downloadInterval);
    modal.style.display = "none";
  });
</script>
</body>
</html>
